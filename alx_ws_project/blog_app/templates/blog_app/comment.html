{% load static %}
<div class="d-flex mb-4">
  {% if comment.user.profile_pic %}
  <div class="flex-shrink-0"><img style="width:50px" class="rounded-circle" src="{{ comment.user.profile_pic.url }}" alt="..." /></div>
  {% else %}
  <div class="flex-shrink-0"><img class="rounded-circle" src="https://dummyimage.com/50x50/ced4da/6c757d.jpg" alt="..." /></div>
  {% endif %}
  <div class="ms-3">
    <div class="fw-bold">{{ comment.user.username }}</div>
    {{ comment.body }}

    <!-- Reply form -->
    {% if request.user.is_authenticated %}
    <a class="btn btn-link btn-sm" data-bs-toggle="collapse" href="#replyForm{{ comment.id }}" role="button" aria-expanded="false" aria-controls="replyForm{{ comment.id }}">Reply</a>
    <div class="collapse" id="replyForm{{ comment.id }}">
      <form method="POST" class="mt-2">
        {% csrf_token %}
        <input type="hidden" name="parent_id" value="{{ comment.id }}">
        {{ comment_form.body }}
        <br>
        <button class="btn btn-primary btn-sm">Reply</button>
      </form>
    </div>
    {% endif %}

    <!-- Nested replies -->
    {% for reply in comment.replies.all %}
      {% include "blog_app/comment.html" with comment=reply %}
    {% endfor %}
  </div>
</div>
